<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Taxonomy.jl</title><link rel="canonical" href="https://banhbio.github.io/Taxonomy.jl/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Taxonomy.jl</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Usage"><span>Usage</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/banhbio/Taxonomy.jl/blob/master/docs/src/index.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Taxonomy.jl"><a class="docs-heading-anchor" href="#Taxonomy.jl">Taxonomy.jl</a><a id="Taxonomy.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Taxonomy.jl" title="Permalink"></a></h1><p><a href="https://banhbio.github.io/Taxonomy.jl/stable"><img src="https://img.shields.io/badge/docs-stable-blue.svg" alt="Stable"/></a> <a href="https://banhbio.github.io/Taxonomy.jl/dev"><img src="https://img.shields.io/badge/docs-dev-blue.svg" alt="Dev"/></a> <a href="https://travis-ci.com/banhbio/Taxonomy.jl"><img src="https://travis-ci.com/banhbio/Taxonomy.jl.svg?token=TnLbrgdWxoQMPrAZynWc&amp;branch=main" alt="Build Status"/></a></p><p>Taxonomy.jl is a julia package to handle NCBI-formatted taxonomic databases.</p><p>Now, this package only supports <code>scientific name</code>.</p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>Install Taxonomy.jl as follows:</p><pre><code class="language-none">julia -e &#39;using Pkg; Pkg.add(&quot;Taxonomy&quot;)&#39;</code></pre><h2 id="Usage"><a class="docs-heading-anchor" href="#Usage">Usage</a><a id="Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Usage" title="Permalink"></a></h2><h3 id="Download-database"><a class="docs-heading-anchor" href="#Download-database">Download database</a><a id="Download-database-1"></a><a class="docs-heading-anchor-permalink" href="#Download-database" title="Permalink"></a></h3><p>First, you need to download taxonomic data from NCBI&#39;s servers.</p><pre><code class="language-none">wget ftp://ftp.ncbi.nlm.nih.gov/pub/taxonomy/taxdump.tar.gz
tar xzvf taxdump.tar.gz</code></pre><h3 id="Create-Taxonomy.DB-object"><a class="docs-heading-anchor" href="#Create-Taxonomy.DB-object">Create <code>Taxonomy.DB</code> object</a><a id="Create-Taxonomy.DB-object-1"></a><a class="docs-heading-anchor-permalink" href="#Create-Taxonomy.DB-object" title="Permalink"></a></h3><p>You can create <code>Taxonomy.DB</code> object to store the data.</p><pre><code class="language-julia"># Load the package
julia&gt; using Taxonomy

julia&gt; db = Taxonomy.DB(&quot;db/nodes.dmp&quot;,&quot;db/names.dmp&quot;) # Create a Taxonomy.DB objext from the path to each file

julia&gt; db = Taxonomy.DB(&quot;/your/path/to/db&quot;,&quot;nodes.dmp&quot;,&quot;names.dmp&quot;) # Alternatively, create the object from the path to the directory and the name of each files</code></pre><h3 id="Taxon"><a class="docs-heading-anchor" href="#Taxon">Taxon</a><a id="Taxon-1"></a><a class="docs-heading-anchor-permalink" href="#Taxon" title="Permalink"></a></h3><p>You can construct a <code>Taxon</code> object from its taxonomic identifier and the <code>Taxonomy.DB</code> object.</p><pre><code class="language-julia">julia&gt; human = Taxon(9606, db) # species Homo sapiens
9606 [species] Homo sapiens

julia&gt; gorilla = Taxon(9593, db) # species Gorilla gorilla
9593 [species] Gorilla gorilla

julia&gt; bacillus = Taxon(1386,db) # genus Bacillus
1386 [genus] Bacillus</code></pre><p>Each <code>Taxon</code> object has 4-field <code>taxid</code>, <code>name</code>, <code>rank</code> and <code>db</code>.</p><pre><code class="language-julia">julia&gt; @show human
human = 9606 [species] Homo sapiens

julia&gt; @show human.taxid
human.taxid = 9606

julia&gt; @show human.name
human.name = &quot;Homo sapiens&quot;

julia&gt; @show human.rank
human.rank = :species

julia&gt; @show human.db
human.db = Taxonomy.DB(&quot;db/nodes.dmp&quot;,&quot;db/names.dmp&quot;)</code></pre><p>You can get a variety of information, such as rank, parent and children by using functions.</p><pre><code class="language-julia">julia&gt; rank(gorilla)
:species

julia&gt; parent(gorilla)
9592 [genus] Gorilla</code></pre><pre><code class="language-julia">julia&gt; children(bacillus)
249-element Array{Taxon,1}:
 427072 [species] Bacillus chagannorensis
 904295 [species] Bacillus ginsengisoli
 1522318 [species] Bacillus kwashiorkori
 1245522 [species] Bacillus thermophilus
 1178786 [species] Bacillus thaonhiensis
 1805474 [species] Bacillus mediterraneensis
 ⋮
 324768 [species] Bacillus idriensis
 745819 [species] Bacillus alkalicola
 170350 [species] Bacillus deramificans
 1522308 [species] Bacillus niameyensis
 324767 [species] Bacillus infantis</code></pre><p>Also, you can get the lowest common ancestor (LCA) of taxa.</p><pre><code class="language-julia">julia&gt; lca(human, gorilla)
207598 [subfamily] Homininae

julia&gt; lca(human, gorilla, bacillus) # You can input as many as you want.
131567 [no rank] cellular organisms

julia&gt; lca([human, gorilla, bacillus]) # Vector of taxon is also ok.
131567 [no rank] cellular organisms</code></pre><p>Fuctions from <code>AbstractTrees.jl</code> can also be used.</p><pre><code class="language-julia">julia&gt; homininae = lca(human, gorilla)
julia&gt; print_tree(homininae)
207598 [subfamily] Homininae
├─ 9596 [genus] Pan
│  ├─ 9597 [species] Pan paniscus
│  └─ 9598 [species] Pan troglodytes
│     ├─ 37010 [subspecies] Pan troglodytes schweinfurthii
│     ├─ 37011 [subspecies] Pan troglodytes troglodytes
│     ├─ 1294088 [subspecies] Pan troglodytes verus x troglodytes
│     ├─ 91950 [subspecies] Pan troglodytes vellerosus
│     ├─ 756884 [subspecies] Pan troglodytes ellioti
│     └─ 37012 [subspecies] Pan troglodytes verus
├─ 9605 [genus] Homo
│  ├─ 9606 [species] Homo sapiens
│  │  ├─ 63221 [subspecies] Homo sapiens neanderthalensis
│  │  └─ 741158 [subspecies] Homo sapiens subsp. &#39;Denisova&#39;
│  ├─ 1425170 [species] Homo heidelbergensis
│  └─ 2665952 [no rank] environmental samples
│     └─ 2665953 [species] Homo sapiens environmental sample
└─ 9592 [genus] Gorilla
   ├─ 499232 [species] Gorilla beringei
   │  ├─ 1159185 [subspecies] Gorilla beringei beringei
   │  └─ 46359 [subspecies] Gorilla beringei graueri
   └─ 9593 [species] Gorilla gorilla
      ├─ 183511 [subspecies] Gorilla gorilla uellensis
      ├─ 406788 [subspecies] Gorilla gorilla diehli
      └─ 9595 [subspecies] Gorilla gorilla gorilla</code></pre><h3 id="Lineage"><a class="docs-heading-anchor" href="#Lineage">Lineage</a><a id="Lineage-1"></a><a class="docs-heading-anchor-permalink" href="#Lineage" title="Permalink"></a></h3><p>Lineage information can be acquired by using <code>Lineage()</code>.</p><pre><code class="language-julia">julia&gt; lineage = Lineage(gorilla)
32-element Lineage:
 1 [no rank] root
 131567 [no rank] cellular organisms
 2759 [superkingdom] Eukaryota
 33154 [clade] Opisthokonta
 33208 [kingdom] Metazoa
 6072 [clade] Eumetazoa
 33213 [clade] Bilateria
 ⋮
 314293 [infraorder] Simiiformes
 9526 [parvorder] Catarrhini
 314295 [superfamily] Hominoidea
 9604 [family] Hominidae
 207598 [subfamily] Homininae
 9592 [genus] Gorilla
 9593 [species] Gorilla gorilla</code></pre><p>Struct <code>Lineage</code> stores linage informaction in <code>Vector</code>-like format.</p><pre><code class="language-julia">julia&gt; lineage[1]
1 [no rank] root

julia&gt; lineage[9]
7711 [phylum] Chordata

julia&gt; lineage[end]
9593 [species] Gorilla gorilla</code></pre><p>You can also access a <code>Taxon</code> in the <code>Lineage</code> using <code>Symbol</code>, such as <code>:superkingdom</code>, <code>:family</code>, <code>:genus</code>, <code>:species</code> and etc.(Only Symbols in CanonicalRank can be used).</p><pre><code class="language-julia">julia&gt; CanonicalRank
10-element Array{Symbol,1}:
 :superkingdom
 :kingdom
 :phylum
 :class
 :order
 :family
 :genus
 :species
 :subspecies
 :strain

julia&gt; lineage[:order]
9443 [order] Primates

julia&gt; lineage[:genus]
9592 [genus] Gorilla</code></pre><p>You can use <code>Between</code>, <code>From</code>, <code>Until</code>, <code>Cols</code> and <code>All</code> selectors in more complex rank selection scenarios.</p><pre><code class="language-julia">julia&gt; lineage[Between(:order,:genus)]
8-element Lineage:
 9443 [order] Primates
 376913 [suborder] Haplorrhini
 314293 [infraorder] Simiiformes
 9526 [parvorder] Catarrhini
 314295 [superfamily] Hominoidea
 9604 [family] Hominidae
 207598 [subfamily] Homininae
 9592 [genus] Gorilla

julia&gt; lineage[From(:family)]
4-element Lineage:
 9604 [family] Hominidae
 207598 [subfamily] Homininae
 9592 [genus] Gorilla
 9593 [species] Gorilla gorilla

julia&gt; lineage[Until(:class)]
19-element Lineage:
 1 [no rank] root
 131567 [no rank] cellular organisms
 2759 [superkingdom] Eukaryota
 33154 [clade] Opisthokonta
 33208 [kingdom] Metazoa
 6072 [clade] Eumetazoa
 33213 [clade] Bilateria
 ⋮
 117570 [clade] Teleostomi
 117571 [clade] Euteleostomi
 8287 [superclass] Sarcopterygii
 1338369 [clade] Dipnotetrapodomorpha
 32523 [clade] Tetrapoda
 32524 [clade] Amniota
 40674 [class] Mammalia</code></pre><p>Reformation of the lineage to your ranks can be performed by using <code>reformat()</code>.</p><pre><code class="language-julia">julia&gt; myrank = [:superkingdom, :phylum, :class, :order, :family, :genus, :species]

julia&gt; reformat(lineage, myrank)
7-element Lineage:
 2759 [superkingdom] Eukaryota
 7711 [phylum] Chordata
 40674 [class] Mammalia
 9443 [order] Primates
 9604 [family] Hominidae
 9592 [genus] Gorilla
 9593 [species] Gorilla gorilla</code></pre><p>If there is no corresponding taxon in the lineage to your ranks, then <code>UnclassifiedTaxon</code> will be stored.</p><pre><code class="language-julia">julia&gt; uncultured_bacillales = Taxon(157472,db)
57472 [species] uncultured Bacillales bacterium

julia&gt; reformated = reformat(Lineage(uncultured_bacillales), myrank)
7-element Lineage:
 2 [superkingdom] Bacteria
 1239 [phylum] Firmicutes
 91061 [class] Bacilli
 1385 [order] Bacillales
 Unclassified [family] unclassified Bacillales family
 Unclassified [genus] unclassified Bacillales genus
 157472 [species] uncultured Bacillales bacterium</code></pre></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 14 January 2022 15:52">Friday 14 January 2022</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
